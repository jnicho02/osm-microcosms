<% content_for :heading do %>
  <h1><%= "Microcosm" %></h1>
<% end %>

<style>
  .mic_row { display: flex }
  .mic_row > div { padding: 10px; }
  .mic_details h1 { margin-top: 0; }
  .mic_details label { font-weight: bold; }
  .mic_details ul { display: inline-block; }
  .mic_details ul > li { display: inline-block; }
  .members > a
  {
    display: block;
    width: 8em;
    height: 8em;
    border: 1px solid #888;
    border-radius: 4px;
    float: left;
    margin: 1em;
    padding: 1em;
    background-color: rgb(238, 238, 238);
    box-sizing: border-box;
    text-decoration: none;
  }
</style>

<div class="mic_row">
  <div>
    <%= image_tag("microcosm_dc.png", size: "400x300") %>
  </div>
  <div class="mic_details">
    <h1>
      <%= link_to @microcosm.name, @microcosm %>
    </h1>
    <p>
      <%= @microcosm.location %>, <%= @microcosm.lat %>, <%= @microcosm.lon %>
    </p>
    <p>
      <%= auto_link @microcosm.description %>
    </p>
    <div>
      <label>Share</label>
      <ul>
        <% @microcosm.microcosm_links.each do |link| %>
          <li>
            <a href="<%= link.url %>"><%= link.site %></a>
          </li>
        <% end %>
      </ul>
    </div>
    <div>
      <label>Organizers</label>
      <ul>
        <% @microcosm.organizers.each do |membership| %>
          <li>
            <%= link_to membership.user.display_name, user_path(membership.user) %>
          </li>
        <% end %>
      </ul>
    </div>

    <%= form_with scope: :microcosm_member, url: microcosm_member_index_path do |form| %>
      <%= form.hidden_field(:microcosm_id, :value => @microcosm.id) %>
      <%= form.hidden_field(:user_id, :value => current_user&.id) %>
      <%= form.submit :value => t('microcosm.join.action') %>
    <% end %>

  </div>
</div>

<div class="mic_row">
  <div>
    <h2>
      <%= link_to 'Upcoming Events', events_of_microcosm_path(@microcosm) %>
    </h2>
    <ul>
      <% @microcosm.events.each do |event| %>
        <li>
          <%= l(event.moment, :format => "%e %B") + ' - ' %> <%= link_to(event.title, event_path(event)) %>
        </li>
      <% end %>
    </ul>
    <h2>
      Recent Changes
    </h2>
    <ul>
      <li>âœ“ 4 September 1:31 OpenBrian - Add brewery</li>
      <li>&nbsp;&nbsp;  5 September  2:22 Geomantic - Tag restaurant as Korean cuisine</li>
      <li>&nbsp;&nbsp;  6 September 2:22 Geobrando - Add playground at day care center</li>
    </ul>
  </div>
  <div>
    <h2>
      <%= link_to 'Members', members_of_microcosm_path(@microcosm) %>
    </h2>
    <div class="members">
      <% @microcosm.microcosm_members.each do |membership| %>
        <%= link_to membership.user.display_name, user_path(membership.user) %>
      <% end %>
    </div>
  </div>
</div>
